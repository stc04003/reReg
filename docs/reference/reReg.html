<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fits Semiparametric Regression Models for Recurrent Event Data — reReg • reReg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fits Semiparametric Regression Models for Recurrent Event Data — reReg" />
<meta property="og:description" content="Fits a general (joint) semiparametric regression model for the recurrent event data,
where the rate function of the underlying recurrent event process and
the hazard function of the terminal event can be specified as a Cox-type model,
an accelerated mean model, an accelerated rate model, or a generalized scale-change model.
See details for model specifications." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/reReg-Recur.html">Creating `Recur` objects</a>
    </li>
    <li>
      <a href="../articles/reReg-cppl.html">Improving Cox-type proportional rate model with `reReg`</a>
    </li>
    <li>
      <a href="../articles/reReg-plot.html">Visualization of recurrent event data with `reReg`</a>
    </li>
    <li>
      <a href="../articles/reReg-reg.html">Regression model for recurrent event data</a>
    </li>
    <li>
      <a href="../articles/reReg-sims.html">Simulating recurrent event data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stc04003/reReg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits Semiparametric Regression Models for Recurrent Event Data</h1>
    <small class="dont-index">Source: <a href='https://github.com/stc04003/reReg/blob/master/R/reReg.R'><code>R/reReg.R</code></a></small>
    <div class="hidden name"><code>reReg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a general (joint) semiparametric regression model for the recurrent event data,
where the rate function of the underlying recurrent event process and
the hazard function of the terminal event can be specified as a Cox-type model,
an accelerated mean model, an accelerated rate model, or a generalized scale-change model.
See details for model specifications.</p>
    </div>

    <pre class="usage"><span class='fu'>reReg</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  <span class='va'>data</span>,
  <span class='va'>subset</span>,
  model <span class='op'>=</span> <span class='st'>"cox"</span>,
  B <span class='op'>=</span> <span class='fl'>0</span>,
  se <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"boot"</span>, <span class='st'>"sand"</span><span class='op'>)</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula object, with the response on the left of a "~" operator,
and the predictors on the right.
The response must be a recurrent event survival object as returned by function <code>Recur</code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame in which to interpret the variables occurring
in the <code>"formula"</code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>an optional logical vector specifying a subset of observations to be used
in the fitting process.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>a character string specifying the underlying model.
The available functional form for the rate function and the hazard function include a Cox-type model,
an accelerated mean model, an accelerated rate model, or a generalized scale-change model,
and can be specified via "cox", "am", "ar", or "gsc", respectively.
The rate function and hazard function separated by "<code><a href='https://rdrr.io/r/base/Logic.html'>|</a></code>".
See <b>Details</b>.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>a numeric value specifies the number of bootstraps for variance estimation.
When <code>B = 0</code>, variance estimation will not be performed.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>a character string specifying the method for the variance estimation. See <b>Details</b>.</p><dl>
   <dt><code>boot</code></dt><dd><p>nonparametric bootstrap approach</p></dd>
   <dt><code>sand</code></dt><dd><p>resampling-based sandwich estimator</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of control parameters. See <code><a href='reReg.control.html'>reReg.control</a></code> for default values.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><b>Model specification:</b></p>
<p>Suppose the recurrent event process and the failure events are
observed in the time interval \(t\in[0,\tau]\),
for some constant \(\tau\).
We formulate the recurrent event rate function, \(\lambda(t)\),
and the terminal event hazard function, \(h(t)\), 
in the form of
$$\lambda(t) = Z \lambda_0(te^{X^\top\alpha}) e^{X^\top\beta}, h(t) = Z h_0(te^{X^\top\eta})e^{X^\top\theta},$$
where \(\lambda_0(t)\) is the baseline rate function,
\(h_0(t)\) is the baseline hazard function,
\(X\) is a \(n\) by \(p\) covariate matrix and \(\alpha\),
\(Z\) is an unobserved shared frailty variable, and
\((\alpha, \eta)\) and \((\beta, \theta)\) correspond to the shape and size parameters,
respectively.
The model includes several popular semiparametric models as special cases,
which can be specified via the <code>model</code> argument with the rate function
and the hazard function separated by "<code><a href='https://rdrr.io/r/base/Logic.html'>|</a></code>".
For examples,
Wang, Qin and Chiang (2001) (\(\alpha = \eta = \theta = 0\))
can be called with <code>model = "cox"</code>;
Huang and Wang (2004) (\(\alpha = \eta = 0\))
can be called with <code>model = "cox|cox"</code>;
Xu et al. (2017) (\(\alpha = \beta\) and \(\eta = \theta\))
can be called with <code>model = "am|am"</code>;
Xu et al. (2019) (\(\eta = \theta = 0\)) can be called with <code>model = "gsc"</code>.
Users can mix the models depending on the application. For example,
<code>model = "cox|ar"</code> postulate a Cox proportional model for the
recurrent event rate function and an accelerated rate model for
the terminal event hazard function (\(\alpha = \theta = 0\)).
If only one model is specified without an "<code><a href='https://rdrr.io/r/base/Logic.html'>|</a></code>",
it is used for both the rate function and the hazard function.
For example, specifying <code>model = "cox"</code> is equivalent to <code>model = "cox|cox"</code>.
Some models that assumes <code>Z = 1</code> and requires independent
censoring are also implemented in <code>reReg</code>;
these includes <code>model = "cox.LWYY"</code> for Lin et al. (2000),
<code>model = "cox.GL"</code> for Ghosh and Lin (2002),
and <code>model = "am.GL"</code> for Ghosh and Lin (2003).
Additionally, an improved estimation of the proportional rate model
(Huang and Huang 2022) can be called by <code>model = "cox.HH"</code> with
additional <code>control</code> options to specify the underlying procedure.
See <a href='www.sychiou.com/reReg/articles/reReg-reg.html'>online vignette</a>
for a detailed discussion of the implemented regression models.</p>
<p><b>Variance estimation:</b></p>
<p>The available methods for variance estimation are:</p><dl>
  <dt>boot</dt><dd><p>performs nonparametric bootstrap.</p></dd>
  <dt>sand</dt><dd><p>performs the efficient resampling-based variance estimation.</p></dd>

</dl>

<p><b>Improving proportional rate model:</b>
A common semiparametric regression model for recurrent event process
under the noninformative censoring assumption is the Cox-type proportional rate model
(available in <code>reReg()</code> via <code>model = "cox.LWYY"</code>).
However, the construction of the pseudo-partial score function ignores the
dependency among recurrent events and thus could be inefficient. 
To improve upon this popular method, Huang and Huang (2022) proposed to combine
a system of weighted pseudo-partial score equations via the generalized method of moments (GMM)
and empirical likelihood (EL) estimation.
The proposed GMM and EL procedures are available in <code>reReg</code> via <code>model = "cox.HH"</code>
with additional control specifications.
See <a href='www.sychiou.com/reReg/articles/reReg-cppl.html'>online vignette</a>
for an illustration of this feature.</p>
<p><b>Control options:</b></p>
<p>The <code>control</code> list consists of the following parameters:</p><dl>
  <dt>tol</dt><dd><p>absolute error tolerance.</p></dd>
  <dt>init</dt><dd><p>a list contains initial guesses used for root search.</p></dd>
  <dt>solver</dt><dd><p>the equation solver used for root search.
The available options are <code><a href='https://rdrr.io/pkg/BB/man/BBsolve.html'>BB::BBsolve</a></code>, <code><a href='https://rdrr.io/pkg/BB/man/dfsane.html'>BB::dfsane</a></code>, <code><a href='https://rdrr.io/pkg/BB/man/BBoptim.html'>BB::BBoptim</a></code>, 
<code><a href='https://rdrr.io/pkg/optimx/man/optimr.html'>optimx::optimr</a></code>, <code><a href='https://rdrr.io/pkg/dfoptim/man/hookejeeves.html'>dfoptim::hjk</a></code>, <code><a href='https://rdrr.io/pkg/dfoptim/man/mads.html'>dfoptim::mads</a></code>, <code>optim</code>,
and <code><a href='https://rdrr.io/pkg/nleqslv/man/nleqslv.html'>nleqslv::nleqslv</a></code>.</p></dd>
  <dt>eqType</dt><dd><p>a character string indicating whether the log-rank type estimating equation or
the Gehan-type estimating equation (when available) will be used.</p></dd>
  <dt>boot.parallel</dt><dd><p>an logical value indicating whether parallel computation
will be applied when <code>se = "boot"</code> is called.</p></dd>
  <dt>boot.parCl</dt><dd><p>an integer value specifying the number of CPU cores to be used when
<code>parallel = TRUE</code>. The default value is half the CPU cores on the current host.</p></dd>
<dt>cppl</dt><dd><p>A character string indicating either to improve the proportional rate model via
the generalized method of moments (<code>cppl = "GMM"</code>) or empirical likelihood estimation (<code>cppl = "EL"</code>).
This option is only used when <code>model = "cox.HH"</code>.</p></dd>
<dt>cppl.wfun</dt><dd><p>A list of (up to two) weight functions to be combined with the weighted pseudo-partial likelihood scores.
Avaialble options are <code>"Gehan"</code> and <code>"cumbase"</code>,
which correspond to the Gehan's weight and the cumulative baseline hazard function, respectively.
Alternatively, the weight functions can be specified with function formulas.
This option is only used when <code>model = "cox.HH"</code>.</p></dd>
<dt>trace</dt><dd><p>A logical variable denoting whether some of the
intermediate results of iterations should be displayed to the user.  Default is <code>FALSE</code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Lin, D., Wei, L., Yang, I. and Ying, Z. (2000). Semiparametric Regression for the Mean and Rate Functions of Recurrent Events.
<em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, <b>62</b>: 711--730.</p>
<p>Wang, M.-C., Qin, J., and Chiang, C.-T. (2001). Analyzing Recurrent Event Data with Informative Censoring.
<em>Journal of the American Statistical Association</em>, <b>96</b>(455): 1057--1065.</p>
<p>Ghosh, D. and Lin, D.Y. (2002). Marginal Regression Models for Recurrent and Terminal Events. <em>Statistica Sinica</em>: 663--688.</p>
<p>Ghosh, D. and Lin, D.Y. (2003). Semiparametric Analysis of Recurrent Events Data in the Presence of Dependent Censoring.
<em>Biometrics</em>, <b>59</b>: 877--885.</p>
<p>Huang, C.-Y. and Wang, M.-C. (2004). Joint Modeling and Estimation for Recurrent Event Processes and Failure Time Data.
<em>Journal of the American Statistical Association</em>, <b>99</b>(468): 1153--1165.</p>
<p>Xu, G., Chiou, S.H., Huang, C.-Y., Wang, M.-C. and Yan, J. (2017). Joint Scale-change Models for Recurrent Events and Failure Time.
<em>Journal of the American Statistical Association</em>, <b>112</b>(518): 796--805.</p>
<p>Xu, G., Chiou, S.H.,Yan, J., Marr, K., and Huang, C.-Y. (2019). Generalized Scale-Change Models for Recurrent Event
Processes under Informative Censoring. <em>Statistica Sinica</em>, <b>30</b>: 1773--1795.</p>
<p>Huang, M.-Y. and Huang, C.-Y. (2022). Improved semiparametric estimation of the proportional rate model with recurrent event data.
<em>In revision</em>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='Recur.html'>Recur</a></code>, <code><a href='simGSC.html'>simGSC</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>simDat</span><span class='op'>)</span>

<span class='co'>## Nonparametric estimate</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>reReg</span><span class='op'>(</span><span class='fu'><a href='Recur.html'>Recur</a></span><span class='op'>(</span><span class='va'>t.start</span> <span class='op'>%to%</span> <span class='va'>t.stop</span>, <span class='va'>id</span>, <span class='va'>event</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>, data <span class='op'>=</span> <span class='va'>simDat</span>, B <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='reReg-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Recur.html'>Recur</a></span><span class='op'>(</span><span class='va'>t.start</span> <span class='op'>%to%</span> <span class='va'>t.stop</span>, <span class='va'>id</span>, <span class='va'>event</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>
<span class='co'>## Fit the Cox rate model</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>reReg</span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>simDat</span>, model <span class='op'>=</span> <span class='st'>"cox"</span>, B <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: 
#&gt; reReg(formula = fm, data = simDat, model = "cox", B = 50)
#&gt; 
#&gt; Recurrent event process:
#&gt;    Estimate   StdErr z.value   p.value    
#&gt; x1 -1.13602  0.13704 -8.2900 &lt; 2.2e-16 ***
#&gt; x2 -1.07493  0.14264 -7.5361 &lt; 2.2e-16 ***
#&gt; </div><div class='input'><span class='co'>## Fit the joint Cox/Cox model</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>reReg</span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>simDat</span>, model <span class='op'>=</span> <span class='st'>"cox|cox"</span>, B <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: 
#&gt; reReg(formula = fm, data = simDat, model = "cox|cox", B = 50)
#&gt; 
#&gt; Recurrent event process:
#&gt;    Estimate   StdErr z.value   p.value    
#&gt; x1 -1.13602  0.13704 -8.2900 &lt; 2.2e-16 ***
#&gt; x2 -1.07493  0.14264 -7.5361 &lt; 2.2e-16 ***
#&gt; </div><div class='input'><span class='co'>## Fit the scale-change rate model</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>reReg</span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>simDat</span>, model <span class='op'>=</span> <span class='st'>"gsc"</span>, B <span class='op'>=</span> <span class='fl'>50</span>, se <span class='op'>=</span> <span class='st'>"sand"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: 
#&gt; reReg(formula = fm, data = simDat, model = "gsc", B = 50, se = "sand")
#&gt; 
#&gt; Recurrent event process:
#&gt;    Estimate   StdErr z.value   p.value    
#&gt; x1 -1.13602  0.13704 -8.2900 &lt; 2.2e-16 ***
#&gt; x2 -1.07493  0.14264 -7.5361 &lt; 2.2e-16 ***
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sy Han (Steven) Chiou, Chiung-Yu  Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


